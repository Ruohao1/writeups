<!-- frontmatter: {
     "title":"Shoppy RSA",
     "date":"2026-02-07",
     "platform":"NCC CTF",
     "event":"MasterCard CTF",
     "category":"Crypto",
     "difficulty":"",
     "tags":["rsa","small-exponent"],
     "summary":"Recovered plaintext from RSA ciphertext using a small public exponent.",
     "image":""
 } -->

# Shoppy RSA

## TL;DR

- **Entry:** Given RSA public key and ciphertext.
- **Execution:** Exploited small public exponent to recover plaintext.
- **PrivEsc:** N/A
- **Loot:** Flag/decoded message.

---

## Recon

### Provided data

```text
N = 70087612095750802474897782193572548414816066721658934639912019535626078836689713180829570834356785932346097956924149891700885636347663313952280519745372333068889789077175105024332746071227475899981520076492499497191481633709596370726408644988407245197419937312130298549692640939517168588306394339920712150347
e = 3
c = 35036840633372864308532070762623024462864401551292453045387087243383569923232370841870640324806876442943169500333627799930540138110950517180428526186381992715424432858232085828085283710524505960251551195622465125483449257534221895706883849217125
```

---

## Vulnerability Analysis

The public exponent is very small (`e = 3`). If the plaintext is smaller than `N^(1/3)` and no padding is used, the ciphertext is just `m^3`, which can be inverted by taking an integer cube root.

---

## Exploitation

### Python script

```bash
python3 - <<'PY'
from math import isclose

N = 70087612095750802474897782193572548414816066721658934639912019535626078836689713180829570834356785932346097956924149891700885636347663313952280519745372333068889789077175105024332746071227475899981520076492499497191481633709596370726408644988407245197419937312130298549692640939517168588306394339920712150347
e = 3
c = 35036840633372864308532070762623024462864401551292453045387087243383569923232370841870640324806876442943169500333627799930540138110950517180428526186381992715424432858232085828085283710524505960251551195622465125483449257534221895706883849217125

def iroot3(n):
    x = int(n ** (1/3))
    while (x + 1) ** 3 <= n:
        x += 1
    while x ** 3 > n:
        x -= 1
    return x

m = iroot3(c)
print(m)
print(m.to_bytes((m.bit_length() + 7) // 8, "big"))
PY
```

### Online tool

![](/nccctf/shoppy-rsa/rsa_online.png)

---

## Notes / Mitigations

Use RSA padding (PKCS#1 v1.5 or OAEP) and avoid tiny public exponents without padding.
